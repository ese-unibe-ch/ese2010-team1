<!DOCTYPE html>
<html>
    <head>
        <title>#{get 'title' /}</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <link rel="stylesheet" type="text/css" media="screen" href="@{'/public/stylesheets/main.css'}">
        
        #{get 'moreStyles' /}
        <link rel="shortcut icon" type="image/png" href="@{'/public/images/favicon.png'}">
        <script src="@{'/public/javascripts/jquery-1.4.2.min.js'}" type="text/javascript" charset="utf-8"></script>
        <script src="@{'/public/javascripts/flot/jquery.flot.js'}" type="text/javascript" charset="utf-8"></script>
        <script src="@{'/public/javascripts/qa.js'}" type="text/javascript" charset="utf-8"></script>
        #{get 'moreScripts' /}
        
        <script src="@{'/public/javascripts/settings.js'}" type="text/javascript"></script>
		<script type="text/javascript">
			pic1 = new Image(16, 16); 
			pic1.src = "@{'/public/images/loader.gif'}";
			
			$(document).ready(function(){
			
			$("#username").change(function() { 
			
			var usr = $("#username").val();
			
			if(usr.length >= 3)
			{
			$("#status").html('<img src="@{'/public/images/loader.gif'}" align="absmiddle">&nbsp;Checking availability...');
			
			    $.ajax({  
			    type: "POST",  
			    url: "@{Application.userCheck()}",  
			    data: "username="+ usr,  
			    success: function(msg){  
			   
			   $("#status").ajaxComplete(function(event, request, settings){ 
			
				if(msg == 'OK')
				{ 
			        $("#username").removeClass('object_error'); // if necessary
					$("#username").addClass("object_ok");
					$(this).html('&nbsp;<img src="@{'/public/images/accepted.png'}" align="absmiddle"> <font color="Green"> Available </font>  ');
				}  
				else  
				{  
					$("#username").removeClass('object_ok'); // if necessary
					$("#username").addClass("object_error");
					$(this).html(msg);
				}  
			   
			   });
			
			 } 
			   
			  }); 
			
			}
			else
				{
				$("#status").html('<font color="red">The username should have at least <strong>3</strong> characters.</font>');
				$("#username").removeClass('object_ok'); // if necessary
		$("#username").addClass("object_error");
		}
	
	});
	
	});
	
	//-->
	</script>
        
       
	             
    </head>
    <body>
    	<div>
    		<header>
    			<a href="@{Application.index}"></a>
    			
    			#{form @Application.search()}
    			<input type="text" id="searchString" name="searchString" style="float: left; margin-right: 5px;" />
    			<input type="submit" value="Search" style="float: left;" />
    			
    			#{/form}
    			<nav>
    				<a href="@{Application.index}">Questions</a>
    				<span>
    					#{if user}
							Hi <a href="@{UserFuncs.showProfile(user.id)}">${user.name}!</a>
							<a href="@{Secured.toggleAdminState()}">Toggle Admin</a>
							<a href="@{Secure.logout}">Logout</a>
						#{/if}
						#{else}
							Not logged in
							<a href="@{Secure.login}">Login</a>
							<a href="@{Application.createUser}">Register</a>
						#{/else}	
    				</span>
    			</nav>
    		</header>
    		<article>
        		#{doLayout /}
        	</article>
        	<footer>
        		A project release sample by ESE Team 1
        	</footer>
        </div>
    </body>
</html>
